{
  "metadata": {
    "title": "Risk Analysis Report - On-Device LLM Deployment",
    "framework": "NIST AI RMF 1.0 + OWASP Top 10 LLM",
    "generated_at": "2025-12-25T03:21:19.144341",
    "scope": "Consumer-grade Apple Silicon laptop, banking context"
  },
  "threat_model": {
    "assets": {
      "model": "Quantized SLM (GGUF/MLX) deployed on device",
      "inference_data": "Data processed during inference (prompts, responses)",
      "device": "Apple Silicon laptop with the model",
      "logs": "Inference logs and metrics",
      "credentials": "Potential API keys or tokens"
    },
    "adversaries": [
      {
        "type": "external_attacker",
        "capability": "medium",
        "motivation": "Access to banking data via prompt injection"
      },
      {
        "type": "insider_threat",
        "capability": "high",
        "motivation": "Data exfiltration via the model"
      },
      {
        "type": "device_thief",
        "capability": "low",
        "motivation": "Physical access to lost/stolen device"
      }
    ],
    "attack_surfaces": [
      "User input (prompts) - injection risk",
      "Documents ingested in context",
      "Model output (generated responses)",
      "Local storage (model, cache, logs)",
      "Model supply chain (origin, integrity)"
    ]
  },
  "risk_taxonomy": [
    {
      "id": "R01",
      "category": "LLM01: Prompt Injection",
      "title": "Prompt Injection via Documents",
      "description": "An internal or external document containing malicious instructions \n                could manipulate the model to reveal sensitive information \n                or execute unauthorized actions.",
      "likelihood": "medium",
      "impact": "high",
      "inherent_risk": "high",
      "residual_risk": "medium",
      "assets": [
        "inference_data",
        "model"
      ],
      "nist_mapping": [
        "MAP 1.1",
        "MEASURE 2.7"
      ],
      "owasp_ref": "LLM01"
    },
    {
      "id": "R02",
      "category": "LLM06: Sensitive Information Disclosure",
      "title": "Sensitive Data Leak via Responses",
      "description": "The model could include sensitive information (account numbers, \n                client data) in its responses, whether through context memorization \n                or inappropriate generation.",
      "likelihood": "medium",
      "impact": "high",
      "inherent_risk": "high",
      "residual_risk": "low",
      "assets": [
        "inference_data"
      ],
      "nist_mapping": [
        "MAP 1.5",
        "MEASURE 2.11"
      ],
      "owasp_ref": "LLM06"
    },
    {
      "id": "R03",
      "category": "Device Loss/Theft",
      "title": "Perte ou Vol du Device",
      "description": "A laptop containing the model and potentially cached data \n                could be lost or stolen, exposing local assets.",
      "likelihood": "low",
      "impact": "high",
      "inherent_risk": "medium",
      "residual_risk": "low",
      "assets": [
        "device",
        "model",
        "logs"
      ],
      "nist_mapping": [
        "GOVERN 1.2",
        "MAP 1.3"
      ],
      "owasp_ref": null
    },
    {
      "id": "R04",
      "category": "LLM05: Supply Chain Vulnerabilities",
      "title": "Model Integrity (Supply Chain)",
      "description": "The downloaded model could be modified, corrupted, or come from \n                an untrusted source. Lack of integrity verification.",
      "likelihood": "low",
      "impact": "high",
      "inherent_risk": "medium",
      "residual_risk": "low",
      "assets": [
        "model"
      ],
      "nist_mapping": [
        "MAP 3.4",
        "MEASURE 2.10"
      ],
      "owasp_ref": "LLM05"
    },
    {
      "id": "R05",
      "category": "Licensing/Compliance",
      "title": "Licensing Non-Compliance",
      "description": "Use of models without verification of license terms,\n                potentially leading to intellectual property violations \n                or commercial use restrictions.",
      "likelihood": "medium",
      "impact": "medium",
      "inherent_risk": "medium",
      "residual_risk": "low",
      "assets": [
        "model"
      ],
      "nist_mapping": [
        "GOVERN 1.4"
      ],
      "owasp_ref": null
    },
    {
      "id": "R06",
      "category": "LLM09: Overreliance",
      "title": "Over-reliance on Model Responses",
      "description": "Users could blindly trust the model's responses \n                without verification, leading to errors in critical \n                banking processes.",
      "likelihood": "medium",
      "impact": "medium",
      "inherent_risk": "medium",
      "residual_risk": "low",
      "assets": [
        "inference_data"
      ],
      "nist_mapping": [
        "MAP 1.6",
        "MEASURE 3.3"
      ],
      "owasp_ref": "LLM09"
    },
    {
      "id": "R07",
      "category": "Data Exfiltration",
      "title": "Exfiltration via Logs/Cache",
      "description": "Inference logs or local cache could contain sensitive data\n                and be exfiltrated via uncontrolled vectors.",
      "likelihood": "low",
      "impact": "high",
      "inherent_risk": "medium",
      "residual_risk": "low",
      "assets": [
        "logs",
        "inference_data"
      ],
      "nist_mapping": [
        "MAP 1.5",
        "MEASURE 2.11"
      ],
      "owasp_ref": null
    }
  ],
  "controls": [
    {
      "id": "C01",
      "title": "Disk Encryption (FileVault)",
      "description": "Enable full disk encryption on all devices.",
      "type": "preventive",
      "mitigates_risks": [
        "R03",
        "R07"
      ],
      "status": "implemented",
      "effectiveness": "high"
    },
    {
      "id": "C02",
      "title": "Input Validation",
      "description": "Implement validation and sanitization of user prompts.",
      "type": "preventive",
      "mitigates_risks": [
        "R01",
        "R02"
      ],
      "status": "planned",
      "effectiveness": "medium"
    },
    {
      "id": "C03",
      "title": "Model Registry",
      "description": "Maintain an internal registry of approved models with SHA256 hash.",
      "type": "preventive",
      "mitigates_risks": [
        "R04",
        "R05"
      ],
      "status": "planned",
      "effectiveness": "high"
    },
    {
      "id": "C04",
      "title": "Minimal Logging Policy",
      "description": "Do not log sensitive data, regularly purge logs.",
      "type": "preventive",
      "mitigates_risks": [
        "R07",
        "R02"
      ],
      "status": "planned",
      "effectiveness": "high"
    },
    {
      "id": "C05",
      "title": "Audit des Licences",
      "description": "Verify and document licenses before deployment.",
      "type": "preventive",
      "mitigates_risks": [
        "R05"
      ],
      "status": "implemented",
      "effectiveness": "high"
    },
    {
      "id": "C06",
      "title": "Output Monitoring",
      "description": "Detect sensitive data patterns in responses.",
      "type": "detective",
      "mitigates_risks": [
        "R02",
        "R06"
      ],
      "status": "planned",
      "effectiveness": "medium"
    },
    {
      "id": "C07",
      "title": "Model Integrity Verification",
      "description": "Verify model hash at startup.",
      "type": "detective",
      "mitigates_risks": [
        "R04"
      ],
      "status": "planned",
      "effectiveness": "high"
    },
    {
      "id": "C08",
      "title": "Remote Wipe Procedure",
      "description": "Ability to remotely wipe device data (MDM).",
      "type": "corrective",
      "mitigates_risks": [
        "R03"
      ],
      "status": "planned",
      "effectiveness": "high"
    },
    {
      "id": "C09",
      "title": "Human-in-the-Loop",
      "description": "Require human validation for critical decisions.",
      "type": "corrective",
      "mitigates_risks": [
        "R06"
      ],
      "status": "implemented",
      "effectiveness": "high"
    }
  ],
  "risk_matrix": {
    "inherent": {
      "R01": {
        "title": "Prompt Injection via Documents",
        "category": "LLM01: Prompt Injection",
        "level": "high"
      },
      "R02": {
        "title": "Sensitive Data Leak via Responses",
        "category": "LLM06: Sensitive Information Disclosure",
        "level": "high"
      },
      "R03": {
        "title": "Perte ou Vol du Device",
        "category": "Device Loss/Theft",
        "level": "medium"
      },
      "R04": {
        "title": "Model Integrity (Supply Chain)",
        "category": "LLM05: Supply Chain Vulnerabilities",
        "level": "medium"
      },
      "R05": {
        "title": "Licensing Non-Compliance",
        "category": "Licensing/Compliance",
        "level": "medium"
      },
      "R06": {
        "title": "Over-reliance on Model Responses",
        "category": "LLM09: Overreliance",
        "level": "medium"
      },
      "R07": {
        "title": "Exfiltration via Logs/Cache",
        "category": "Data Exfiltration",
        "level": "medium"
      }
    },
    "residual": {
      "R01": {
        "title": "Prompt Injection via Documents",
        "category": "LLM01: Prompt Injection",
        "level": "medium"
      },
      "R02": {
        "title": "Sensitive Data Leak via Responses",
        "category": "LLM06: Sensitive Information Disclosure",
        "level": "low"
      },
      "R03": {
        "title": "Perte ou Vol du Device",
        "category": "Device Loss/Theft",
        "level": "low"
      },
      "R04": {
        "title": "Model Integrity (Supply Chain)",
        "category": "LLM05: Supply Chain Vulnerabilities",
        "level": "low"
      },
      "R05": {
        "title": "Licensing Non-Compliance",
        "category": "Licensing/Compliance",
        "level": "low"
      },
      "R06": {
        "title": "Over-reliance on Model Responses",
        "category": "LLM09: Overreliance",
        "level": "low"
      },
      "R07": {
        "title": "Exfiltration via Logs/Cache",
        "category": "Data Exfiltration",
        "level": "low"
      }
    }
  },
  "control_mapping": {
    "R01": {
      "risk_title": "Prompt Injection via Documents",
      "inherent_risk": "high",
      "controls": [
        {
          "id": "C02",
          "title": "Input Validation",
          "type": "preventive",
          "status": "planned",
          "effectiveness": "medium"
        }
      ],
      "residual_risk": "medium"
    },
    "R02": {
      "risk_title": "Sensitive Data Leak via Responses",
      "inherent_risk": "high",
      "controls": [
        {
          "id": "C02",
          "title": "Input Validation",
          "type": "preventive",
          "status": "planned",
          "effectiveness": "medium"
        },
        {
          "id": "C04",
          "title": "Minimal Logging Policy",
          "type": "preventive",
          "status": "planned",
          "effectiveness": "high"
        },
        {
          "id": "C06",
          "title": "Output Monitoring",
          "type": "detective",
          "status": "planned",
          "effectiveness": "medium"
        }
      ],
      "residual_risk": "low"
    },
    "R03": {
      "risk_title": "Perte ou Vol du Device",
      "inherent_risk": "medium",
      "controls": [
        {
          "id": "C01",
          "title": "Disk Encryption (FileVault)",
          "type": "preventive",
          "status": "implemented",
          "effectiveness": "high"
        },
        {
          "id": "C08",
          "title": "Remote Wipe Procedure",
          "type": "corrective",
          "status": "planned",
          "effectiveness": "high"
        }
      ],
      "residual_risk": "low"
    },
    "R04": {
      "risk_title": "Model Integrity (Supply Chain)",
      "inherent_risk": "medium",
      "controls": [
        {
          "id": "C03",
          "title": "Model Registry",
          "type": "preventive",
          "status": "planned",
          "effectiveness": "high"
        },
        {
          "id": "C07",
          "title": "Model Integrity Verification",
          "type": "detective",
          "status": "planned",
          "effectiveness": "high"
        }
      ],
      "residual_risk": "low"
    },
    "R05": {
      "risk_title": "Licensing Non-Compliance",
      "inherent_risk": "medium",
      "controls": [
        {
          "id": "C03",
          "title": "Model Registry",
          "type": "preventive",
          "status": "planned",
          "effectiveness": "high"
        },
        {
          "id": "C05",
          "title": "Audit des Licences",
          "type": "preventive",
          "status": "implemented",
          "effectiveness": "high"
        }
      ],
      "residual_risk": "low"
    },
    "R06": {
      "risk_title": "Over-reliance on Model Responses",
      "inherent_risk": "medium",
      "controls": [
        {
          "id": "C06",
          "title": "Output Monitoring",
          "type": "detective",
          "status": "planned",
          "effectiveness": "medium"
        },
        {
          "id": "C09",
          "title": "Human-in-the-Loop",
          "type": "corrective",
          "status": "implemented",
          "effectiveness": "high"
        }
      ],
      "residual_risk": "low"
    },
    "R07": {
      "risk_title": "Exfiltration via Logs/Cache",
      "inherent_risk": "medium",
      "controls": [
        {
          "id": "C01",
          "title": "Disk Encryption (FileVault)",
          "type": "preventive",
          "status": "implemented",
          "effectiveness": "high"
        },
        {
          "id": "C04",
          "title": "Minimal Logging Policy",
          "type": "preventive",
          "status": "planned",
          "effectiveness": "high"
        }
      ],
      "residual_risk": "low"
    }
  },
  "summary": {
    "total_risks": 7,
    "residual_risk_distribution": {
      "critical": 0,
      "high": 0,
      "medium": 1,
      "low": 6
    },
    "total_controls": 9,
    "control_implementation_status": {
      "implemented": 3,
      "in_progress": 0,
      "planned": 6
    },
    "key_findings": [
      "On-device deployment reduces network leakage risks",
      "Disk encryption is critical for asset protection",
      "Input validation remains the main security challenge",
      "Model governance (licensing, integrity) must be formalized"
    ],
    "recommendations": [
      "Implement prompt validation before inference",
      "Establish a formal model registry with integrity verification",
      "Define a logging policy minimizing data retention",
      "Train users on SLM limitations (avoid over-reliance)"
    ]
  }
}